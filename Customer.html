<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Customer Entry Form</title>
    <link rel="icon" href="https://www.polisheddiamonds.co.nz/wp-content/uploads/2023/02/lab-grown-diamond.png"
        type="image/x-icon">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <style>
        @import url(https://fonts.googleapis.com/css?family=Lato:300,400,700);

        :root {
            --primary: #4f6fad;
            --primary-light: #5f7db6;
            --primary-dark: #374d78;
            --secondary: #ee9cb4;
            --light: #f8f9fa;
            --dark: #343a40;
            --gray: #6c757d;
            --light-gray: #e9ecef;
        }

        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            font-family: "Lato", sans-serif;
            font-weight: 400;
            min-height: 100vh;
            padding: 20px 0;
        }

        .container {
            max-width: 650px;
            background-color: #fff;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            margin-bottom: 30px;
        }

        .header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            padding: 2.5rem 2.5rem 1.5rem;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url(https://images2.imgbox.com/a5/2e/m3lRbCCA_o.jpg) center/cover;
            opacity: 0.2;
            z-index: 0;
        }

        .header-content {
            position: relative;
            z-index: 1;
        }

        h1 {
            font-weight: 300;
            font-size: 2.8rem;
            margin-bottom: 0.5rem;
            position: relative;
            display: inline-block;
        }

        h1::after {
            content: "";
            position: absolute;
            bottom: -10px;
            left: 25%;
            width: 50%;
            height: 2px;
            background: rgba(255, 255, 255, 0.5);
        }

        .subtitle {
            font-weight: 300;
            font-size: 1.1rem;
            margin-top: 1.2rem;
            opacity: 0.9;
        }

        .form-container {
            padding: 2rem 2.5rem;
        }

        .form-section {
            margin-bottom: 1.5rem;
            padding: 1.5rem;
            border-radius: 8px;
            background-color: var(--light);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }

        .section-title {
            color: var(--primary);
            font-size: 1.2rem;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid var(--light-gray);
            font-weight: 600;
        }

        .form-label {
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 0.5rem;
        }

        .form-control, .form-select {
            border-radius: 6px;
            padding: 0.75rem 1rem;
            border: 1px solid #ced4da;
            transition: all 0.3s;
        }

        .form-control:focus, .form-select:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 0.25rem rgba(79, 111, 173, 0.25);
        }

        .required::after {
            content: " *";
            color: var(--secondary);
        }

        .btn-submit {
            background: linear-gradient(to right, var(--primary) 0%, var(--primary-light) 100%);
            border: none;
            border-radius: 6px;
            padding: 0.75rem 2rem;
            font-weight: 600;
            font-size: 1.1rem;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(79, 111, 173, 0.3);
            width: 200px;
        }

        .btn-submit:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(79, 111, 173, 0.4);
        }

        .btn-submit:disabled {
            opacity: 0.7;
            cursor: not-allowed;
            transform: none;
        }

        .divider {
            height: 1px;
            background: linear-gradient(to right, var(--secondary), var(--primary));
            margin: 2rem 0;
            opacity: 0.7;
        }

        .form-row {
            display: flex;
            flex-wrap: wrap;
            margin: 0 -10px;
        }

        .form-group {
            flex: 1 0 250px;
            padding: 0 10px;
            margin-bottom: 1.5rem;
        }

        textarea {
            min-height: 120px;
            resize: vertical;
        }

        .field-info {
            font-size: 0.85rem;
            color: var(--gray);
            margin-top: 0.25rem;
        }

        /* Loading Spinner Styles - UPDATED FOR CENTERING */
        .loading-container {
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 1rem 0;
            width: 100%;
            text-align: center;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(79, 111, 173, 0.3);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s ease-in-out infinite;
            margin: 0 auto 1rem auto;
        }

        .loading-text {
            color: var(--primary);
            font-weight: 600;
            font-size: 1.1rem;
            text-align: center;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        @media (max-width: 576px) {
            .container {
                border-radius: 0;
                margin: 0;
            }
            
            .form-container {
                padding: 1.5rem 1.25rem;
            }
            
            .header {
                padding: 2rem 1.5rem 1rem;
            }
            
            h1 {
                font-size: 2.2rem;
            }
        }
    </style>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
</head>

<body>
    <div class="container">
        <div class="header">
            <div class="header-content">
                <h1>Customer Entry Form</h1>
                <p class="subtitle">Add new customer information to the database</p>
            </div>
        </div>
        <div class="form-container">
            <form method="POST" id="CustomerForm" name="CustomerForm"
                action="https://script.google.com/macros/s/AKfycbyMFDpkUoiaJaJsOt9emXqgy7FJll1h2MfsBjd40s6FbiOfagZoxt6eUyZ85i9j9F9Sgg/exec">
                
                <!-- Customer Information Section -->
                <div class="form-section">
                    <h3 class="section-title">Customer Information</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="FirstName" class="form-label required">First Name</label>
                            <input type="text" name="First Name" class="form-control" id="FirstName" 
                                   placeholder="Enter customer's first name" required>
                            <div class="field-info">Required field</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="LastName" class="form-label">Last Name</label>
                            <input type="text" name="Last Name" class="form-control" id="LastName" 
                                   placeholder="Enter customer's last name">
                            <div class="field-info">Optional field</div>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="Email" class="form-label required">Email</label>
                            <input type="email" name="Email" class="form-control" id="Email" 
                                   placeholder="Enter customer's email address" required>
                            <div class="field-info">Required field - must be valid email format</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="Phone" class="form-label">Phone</label>
                            <input type="tel" name="Phone" class="form-control" id="Phone" 
                                   placeholder="Enter customer's phone number">
                            <div class="field-info">Optional field - include area code</div>
                        </div>
                    </div>
                </div>
                
                <!-- Referral Information Section -->
                <div class="form-section">
                    <h3 class="section-title">Referral Information</h3>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="FindUs" class="form-label">How did you find us?</label>
                            <select class="form-select" name="How did you find us?" id="FindUs">
                                <option value="" selected>Select an option</option>
                                <option value="Storefront / Passing By">Storefront / Passing By</option>
                                <option value="Word-of-mouth">Word-of-mouth</option>
                                <option value="Google / Google Maps">Google / Google Maps</option>
                                <option value="Bing">Bing</option>
                                <option value="Apple Maps">Apple Maps</option>
                                <option value="Other">Other</option>
                            </select>
                            <div class="field-info">Optional field</div>
                        </div>
                    </div>
                    
                    <!-- Other Details Field - Initially Hidden -->
                    <div class="form-row" id="OtherDetailsContainer" style="display: none;">
                        <div class="form-group">
                            <label for="OtherDetails" class="form-label">Please specify</label>
                            <input type="text" name="Other Details" class="form-control" id="OtherDetails" 
                                   placeholder="Please specify how you found us">
                            <div class="field-info">Please provide details about how you found us</div>
                        </div>
                    </div>
                </div>
                
                <div class="divider"></div>
                
                <div class="text-center">
                    <button type="submit" class="btn btn-submit" id="submitButton">Add to Customer Database</button>
                    <div class="loading-container" id="loadingContainer">
                        <div class="spinner"></div>
                        <div class="loading-text">Submitting...</div>
                    </div>
                    <p class="mt-2 text-muted" id="submitHint">or press <strong>Enter</strong> to submit</p>
                </div>
            </form>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
        crossorigin="anonymous"></script>

    <script>
        $(document).ready(function () {
            let isSubmitting = false;
            
            // Handle "How did you find us?" dropdown change
            $("#FindUs").change(function() {
                const selectedValue = $(this).val();
                
                if (selectedValue === "Other") {
                    // Show the Other Details input field
                    $("#OtherDetailsContainer").show();
                    $("#OtherDetails").prop("disabled", false);
                } else {
                    // Hide the Other Details input field
                    $("#OtherDetailsContainer").hide();
                    $("#OtherDetails").prop("disabled", true).val("");
                }
            });
            
            // Form submission handler
            $("form").submit(function (e) {
                // Prevent double submission
                if (isSubmitting) {
                    e.preventDefault();
                    return false;
                }
                
                // Basic email validation
                const email = $("#Email").val();
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                
                if (!emailRegex.test(email)) {
                    alert("Please enter a valid email address");
                    e.preventDefault();
                    return false;
                }
                
                // Handle "Other" selection logic
                const findUsDropdown = $("#FindUs");
                const otherDetails = $("#OtherDetails");
                
                if (findUsDropdown.val() === "Other") {
                    // If user selected "Other" and provided details
                    if (otherDetails.val().trim() !== "") {
                        // Create a new value that combines "Other: " with the user's input
                        const customValue = "Other: " + otherDetails.val().trim();
                        
                        // Create a temporary option element with the custom value
                        const tempOption = $("<option></option>")
                            .val(customValue)
                            .text(customValue)
                            .prop("selected", true);
                        
                        // Replace the "Other" option with our custom option
                        findUsDropdown.find('option[value="Other"]').replaceWith(tempOption);
                        
                        // Also update the select value
                        findUsDropdown.val(customValue);
                    } else {
                        // If user selected "Other" but didn't provide details, keep it as just "Other"
                        // Show warning but allow submission
                        if (!confirm("You selected 'Other' but didn't provide details. Would you like to continue with just 'Other'?")) {
                            e.preventDefault();
                            return false;
                        }
                    }
                }
                
                // If validation passes, show loading state but DON'T prevent default form submission
                isSubmitting = true;
                $("#submitButton").hide();
                $("#loadingContainer").show();
                $("#submitHint").hide();
                
                // The form will continue with its normal submission and redirect to Google Apps Script
                // This is what makes the data populate correctly in your spreadsheet
                
                return true;
            });
            
            // Enable form submission on Enter key press in any input field
            $("#CustomerForm input").keypress(function (e) {
                if (e.which === 13) {
                    e.preventDefault();
                    $("#CustomerForm").submit();
                }
            });
        });
    </script>
</body>
</html>
